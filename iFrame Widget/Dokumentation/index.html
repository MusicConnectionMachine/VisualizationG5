<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <title>MusicConnectionMachine Widget</title>

        <!-- Bootstrap -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
        <link href="style.css" rel="stylesheet">
    </head>
    <body data-spy="scroll" data-target="#navbar">
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container-fluid">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">MusicConnectionMachine Widget</a>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="navbar">
                    <ul class="nav navbar-nav navbar-right" id="navItems">
                        <li><a href="#features">Features</a></li>
                        <li><a href="#demo">Demo</a></li>
                        <li><a href="#embedding">Embedding</a></li>
                        <li><a href="#embeddingToComponent">Component Instructions</a></li>
                    </ul>
                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
        </nav>

        <div class="container" id="content">
            <div class="card" id="features">
                <div class="page-header">
                    <h1>Features</h1>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <h2>Timeline Component</h2>
                        <p>
                            The Timeline Component presents all the interesting events and life stations of composers. Here you can have access to very interesting facts - illustrated in a very lovely and easy understanding way.
                        </p>
                    </div>
                    <div class="col-sm-6">
                        <h2>Relations Component</h2>
                        <p>
                            The relations component is a great way for users to explore interesting but less known facts about music pieces, composers and musicians. Users have the possibility to search and browse through all the relations and related entities of a given entity of interest.
                        </p>
                    </div>
                </div>
            </div>
            <div class="card" id="demo">
                <div class="page-header">
                    <h1>Widget Demo</h1>
                </div>
                <div id="timelineComponent">
                    <h2>Timeline Component</h2>
                    <iframe src="" width="100%" height="400px" id="timelineWidget">
                    </iframe>
                </div>
                <div id="relationsComponent">
                    <h2>Relations Component</h2>
                    <iframe src="" width="100%" height="288px" id="relationsWidget">
                    </iframe>
                </div>
            </div>
            <div class="card" id="embedding">
                <div class="page-header">
                    <h1>Embedding the Widget on your Website</h1>
                </div>
                <h3>HTML</h3>
                <figure class="highlight">
                    <pre><code class="language-html" data-lang="html"><span class="tag">&lt;iframe</span> <span class="attr">width=</span><span class="style">"100%"</span> <span class="attr">height=</span><span class="style">"300px"</span> <span class="attr">id="</span><span class="style">widget</span><span class="attr">"</span><span class="tag">&gt;</span><br><span class="tag">&lt;/iframe&gt;</span></code></pre>
                </figure>
                <h3>JavaScript</h3>
                <figure class="highlight">
                    <pre><code class="language-html" data-lang="html"><span class="function">function</span> <span class="functionName">startUpWidget()</span> {<br>    <span class="var">var</span> <span class="varName">urlAppendix</span>;<br>    <span class="comment">//If Composer</span><br>    <span class="varName">urlAppendix</span> = <span class="string">"Composer:"</span> + <span class="varName">composer</span>;<br>    <span class="comment">//If Composition and Composer</span><br>    <span class="varName">urlAppendix</span> = <span class="string">"Composition:"</span> + <span class="varName">composition</span> +<span class="string">";"</span> + <span class="string">"Composer:"</span> + <span class="varName">composer</span>;<br>    <span class="comment">//Change URL to domain</span><br>    <span class="tag">document</span>.getElementById(<span class="style">"widget"</span>).src = <span class="string">"WIDGET-URL"</span> + <span class="string">"?"</span> + <span class="varName">urlAppendix</span>;<br>}<br><span class="functionName">startUpWidget()</span>;
                        </code></pre>
                </figure>
                <div class="row">
                    <div class="col-sm-6">
                        <h4>Widget URLs <small>Change inside JavaScript</small></h4>
                            <h5>Timeline Component</h5>
                            <samp>http://example.com/timeline-app.html</samp>
                            <h5>Relations Component</h5>
                            <samp>http://example.com/relations-app.html</samp>
                    </div>
                    <div class="col-sm-6">
                        <h4>Style for the variables</h4>
                        <p>
                            <span class="varName">Composer:</span> Firstname + "_" + Lastname. <br><i>Example: </i> <span class="comment">Ludwig_van_Beethoven</span> <br>
                            <span class="varName">Composition:</span> Blanks are replaced with "_". <br><i>Example: </i><span class="comment">An_die_Hoffnung,_Op.32</span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="card" id="embeddingToComponent">
                <div class="page-header">
                    <h1>Embedding to Component</h1>
                </div>
                <h3>Receive Data from Parent Site via JavaScript</h3>
                <figure class="highlight">
                    <pre><code class="language-html" data-lang="html"><span class="functionName">getData()</span> {<br>    <span class="var">const</span> <span class="varName">url</span> = window.location.href;<br>    <span class="var">let</span> <span class="varName">composer</span> = <span class="varName">url</span>.slice(<span class="varName">url</span>.indexOf(<span class="string">'Composer'</span>) + <span class="string">'Composer:'</span>.length);<br>    <span class="var">let</span> <span class="varName">composition</span>;<br>    <span class="varName">composer</span> = <span class="varName">composer</span>.replace(new RegExp(<span class="string">'_'</span>, <span class="string">'g'</span>), <span class="string">' '</span>);<br>    if (<span class="varName">url</span>.indexOf(<span class="string">'Composition'</span>) >= 0) {<br>        <span class="varName">composition</span> = <span class="varName">url</span>.slice(<span class="varName">url</span>.indexOf(<span class="string">'Composition:'</span>) + <span class="string">'Composition:'</span>.length, <span class="varName">url</span>.indexOf(<span class="string">';Composer'</span>));<br>        <span class="varName">composition</span> = <span class="varName">composition</span>.replace(new RegExp(<span class="string">'_'</span>, <span class="string">'g'</span>), <span class="string">' '</span>);<br>    }<br>}</code></pre>
            </div>
        </div>

        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <!-- Include all compiled plugins (below), or include individual files as needed -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script>
            function startUpWidget() {
                //Transform URL to Information
                //var url = window.location.href;
                //Only for Testing!
                var url = "http://imslp.org/wiki/Studien_im_Generalbass,_Contrapunkt_und_in_der_Compositionslehre_(Beethoven,_Ludwig_van)";
                var indexToCutOut = url.indexOf("wiki") + 5;
                var urlAppendix;
                //If Category => Composer
                if (url.indexOf("Category") >= 0) {
                    indexToCutOut = indexToCutOut + 9;
                    url = url.slice(indexToCutOut);
                    var lastname = url.slice(0,url.indexOf(","));
                    var firstname = url.slice(url.indexOf(",")+2)
                    urlAppendix =  "Composer:" + firstname + "_" + lastname;
                }
                else {
                    url = url.slice(indexToCutOut);
                    var composition = url.slice(0,url.indexOf("(")-1);
                    var composerPart = url.slice(url.indexOf("(")+1);
                    var lastname = composerPart.slice(0,composerPart.indexOf(","));
                    var firstname = composerPart.slice(composerPart.indexOf(",")+2,composerPart.length-1);
                    var composer = firstname + "_" + lastname;
                    urlAppendix = "Composition:" + composition + ";Composer:" + composer;
                }
                //CHANGE URL to domain
                document.getElementById("timelineWidget").src = "Widget-Url" + "?" + urlAppendix;
                document.getElementById("relationsWidget").src = "Widget-Url" +"?" + urlAppendix;
                console.log(urlAppendix);
            }
            startUpWidget();
        </script>
    </body>
</html>
